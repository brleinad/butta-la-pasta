# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a React Native mobile application built with Expo SDK 54. The project uses TypeScript with strict mode enabled and supports iOS, Android, and web platforms. The app uses React Native's new architecture (enabled via `newArchEnabled: true`).

## Development Commands

- `npm start` - Start the Expo development server
- `npm run android` - Start on Android emulator/device
- `npm run ios` - Start on iOS simulator/device
- `npm run web` - Start web development server

## Styling

**IMPORTANT**: This project uses **Tailwind CSS via NativeWind** for all styling. Always use `className` prop with Tailwind utility classes instead of React Native's `StyleSheet` or inline styles.

Example:
```tsx
<View className="flex-1 bg-white items-center justify-center">
  <Text className="text-lg font-bold text-blue-500">Hello</Text>
</View>
```

The `global.css` file must be imported in the root component to enable Tailwind.

## Architecture

**Entry Point**: `index.ts` registers the root component using `registerRootComponent` from Expo, which handles platform-specific setup for both Expo Go and native builds.

**Main Component**: `App.tsx` is the root component with a simple single-view layout. It imports `global.css` to enable Tailwind CSS styling.

**Configuration**:
- `app.json` contains Expo configuration including app metadata, platform-specific settings, and asset paths
- `tsconfig.json` extends Expo's base TypeScript config with strict mode enabled
- `tailwind.config.js` configures Tailwind CSS with NativeWind preset
- `babel.config.js` configures Babel with Expo preset and NativeWind plugin
- `nativewind-env.d.ts` provides TypeScript support for className prop
- `global.css` contains Tailwind directives (base, components, utilities)

**Platform Support**:
- iOS: Supports tablets
- Android: Uses adaptive icons, edge-to-edge display, and has predictive back gestures disabled
- Web: Uses standard favicon

## Key Dependencies

- Expo ~54.0.12
- React 19.1.0
- React Native 0.81.4
- TypeScript ~5.9.2
- NativeWind ^4.2.1 (Tailwind CSS for React Native)
- Tailwind CSS ^3.4.18

## Backend API (`api/` directory)

This project includes a Go-based REST API backend built with Go 1.24 using the standard library. The codebase was generated by [Autostrada](https://autostrada.dev/).

**Module Path**: `dev.brleinad/butta-la-pasta`

**Development Commands**:
- `cd api && go run ./cmd/api` - Start the API server (default port: 7020)
- `cd api && make run` - Build and run the API
- `cd api && make run/live` - Run with live reload (uses air)
- `cd api && make test` - Run all tests
- `cd api && make audit` - Run quality control checks

**API Structure**:
- **Entry Point**: `cmd/api/main.go` - Parses config from environment variables and starts the server
- **Handlers**: `cmd/api/handlers.go` - HTTP request handlers (currently has `GET /status`)
- **Routes**: `cmd/api/routes.go` - Route mappings and middleware chain
- **Middleware**: `cmd/api/middleware.go` - Custom middleware (includes logAccess, recoverPanic)
- **Helpers**: `cmd/api/helpers.go` - Common helper functions including backgroundTask()
- **Internal Packages**:
  - `internal/database/` - Database setup, connection, and queries (SQLite3)
  - `internal/env/` - Environment variable helpers (GetString, GetInt, GetBool)
  - `internal/request/` - JSON request decoding utilities
  - `internal/response/` - JSON response encoding utilities
  - `internal/validator/` - Request validation helpers
  - `internal/version/` - Application version management

**Database**:
- **Type**: SQLite3 with sqlx extensions
- **File**: `api/db.sqlite` (configurable via `DB_DSN` env var)
- **Migrations**: Located in `assets/migrations/`, embedded at build time
- **Auto-migrate**: Enabled by default (disable via `DB_AUTOMIGRATE=false`)
- **Migration Commands**:
  - `make migrations/new name=<name>` - Create new migration
  - `make migrations/up` - Apply all up migrations
  - `make migrations/down` - Apply all down migrations

**Key Go Dependencies**:
- github.com/jmoiron/sqlx - SQL extensions
- github.com/mattn/go-sqlite3 - SQLite3 driver
- github.com/golang-migrate/migrate/v4 - Database migrations
- github.com/lmittmann/tint - Structured logging (slog)
- github.com/tomasen/realip - Real IP middleware

**Environment Variables**:
- `BASE_URL` - Base URL for the API (default: http://localhost:7020)
- `HTTP_PORT` - Server port (default: 7020)
- `DB_DSN` - Database connection string (default: db.sqlite?_foreign_keys=on)
- `DB_AUTOMIGRATE` - Auto-run migrations on startup (default: true)

**Server Configuration**:
- Read timeout: 5 seconds
- Write timeout: 10 seconds
- Idle timeout: 1 minute
- Graceful shutdown: 30 seconds
- Supports graceful shutdown on SIGINT/SIGTERM
